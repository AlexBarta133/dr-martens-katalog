<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dr. Martens – katalog | Poslední kusy</title>
  <meta name="description" content="Katalog posledních párů Dr. Martens. Kontakt přes WhatsApp / Messenger – domluvíme doručení / dobírku / osobně.">

  <style>
    :root{ --bg:#0b0b0c; --panel:#121214; --muted:#7a7a80; --text:#eaeaf0; --brand:#ffd200; --brand-ink:#151515; --radius:18px; --shadow:0 10px 30px rgba(0,0,0,.35) }
    html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
    a{color:inherit}

    .topbar{
      position:sticky;top:0;z-index:40;
      background:linear-gradient(180deg, rgba(18,18,20,.96), rgba(18,18,20,.86));
      backdrop-filter: blur(8px);
      border-bottom:1px solid #1e1e22;
      padding-top: env(safe-area-inset-top);
      transition: transform .25s ease;
    }
    .topbar.hide{ transform: translateY(calc(-100% - env(safe-area-inset-top))); }

    .container{max-width:1100px;margin:0 auto;padding:16px}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:42px;height:42px;border-radius:12px;background:var(--brand);color:var(--brand-ink);display:grid;place-items:center;font-weight:800}
    .brand h1{font-size:20px;margin:0}
    .brand small{color:var(--muted)}

    .controls{display:grid;grid-template-columns: 1fr 140px 160px;gap:10px;margin-top:12px}
    .input,select,button{background:#1a1a1f;border:1px solid #26262b;color:var(--text);border-radius:12px;padding:12px 14px;font-size:14px}
    .input:focus,select:focus{outline:2px solid #2a2a33;border-color:#2a2a33}
    .cta{background:var(--brand);color:#111;font-weight:700;border:none;cursor:pointer}
    .cta:active{transform:translateY(1px)}

    .hero{display:flex;align-items:center;justify-content:space-between;gap:16px;padding:18px 16px 8px}
    .hero p{margin:0;color:var(--muted)}
    .badges{display:flex;flex-wrap:wrap;gap:8px}
    .badge{padding:6px 10px;border-radius:999px;background:#1a1a1f;border:1px solid #26262b;color:#c9c9cf;font-size:12px}
    .badge.brand{background:var(--brand);color:#111;border:none;font-weight:800}

    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:14px;padding:16px}
    .card{background:linear-gradient(180deg,#151518,#121214);border:1px solid #1c1c21;border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden;display:flex;flex-direction:column}
    .media{position:relative;background:#0f0f12;height:250px;display:grid;place-items:center;overflow:hidden;cursor:pointer}
    .media::after{content:"";position:absolute;inset:0;background:rgba(0,0,0,0);transition:background .3s ease}
    .media img{width:100%;height:100%;object-fit:cover;display:block;transition:transform .3s ease}
    .media:hover img{transform:scale(1.05)}
    .media:hover::after{background:rgba(0,0,0,.08)}
    .flag{position:absolute;top:10px;left:10px;background:var(--brand);color:#111;padding:6px 10px;border-radius:999px;font-weight:800;font-size:12px}
    .sold{position:absolute;top:10px;right:10px;background:#1a1a1f;border:1px solid #2a2a2f;color:#bbb;padding:6px 10px;border-radius:999px;font-size:12px}
    .body{padding:14px 14px 10px;display:flex;flex-direction:column;gap:8px}
    .title{font-weight:800;letter-spacing:.2px}
    .meta{color:#c9c9cf;font-size:13px}
    .price{display:flex;align-items:baseline;gap:8px}
    .price .now{font-weight:900;font-size:20px}
    .price .was{color:#999;text-decoration:line-through}
    .sizes{display:flex;flex-wrap:wrap;gap:8px;margin-top:4px}
    .size{padding:6px 10px;border:1px dashed #2a2a31;border-radius:10px;font-size:12px;color:#cfcfda}
    .actions{display:flex;gap:8px;margin-top:auto;padding:12px 14px;border-top:1px solid #1d1d22}
    .btn{flex:1;display:inline-flex;justify-content:center;align-items:center;gap:8px;padding:11px 12px;border-radius:12px;border:1px solid #26262b;background:#1a1a1f;color:#f0f0f5;text-decoration:none;font-weight:700}

    footer{padding:30px 16px;color:#bfbfc6;border-top:1px solid #1c1c22}
    footer a{color:#fff;text-decoration:underline dotted}

    dialog{width:min(880px,92vw);border:none;border-radius:20px;background:#0f0f12;color:var(--text);box-shadow:var(--shadow)}
    dialog::backdrop{background:rgba(0,0,0,.6)}
    .modal{display:grid;grid-template-columns:1fr 1fr}
    .modal .left{
      padding:0;background:#0a0a0c;position:relative;
      max-height:72vh;display:flex;align-items:center;justify-content:center;
    }
    .modal .left img{
      max-width:100%;max-height:72vh;width:auto;height:auto;object-fit:contain;
    }
    .modal .right{padding:18px}
    .modal h3{margin:0 0 6px 0}
    .modal .muted{color:#b9b9c0}
    .modal .opt{display:flex;gap:10px;margin:12px 0 16px}
    .opt select{flex:1}
    .close{
      position:absolute;top:10px;right:10px;border:none;background:#1a1a1f;border:1px solid #2a2a2f;color:#ddd;
      border-radius:12px;padding:0;width:44px;height:44px;display:grid;place-items:center;font-size:20px;cursor:pointer;z-index:5;
    }
    .navbtn{position:absolute;top:50%;transform:translateY(-50%);background:rgba(0,0,0,.5);border:1px solid #2a2a2f;color:#fff;border-radius:12px;padding:8px 12px;cursor:pointer}
    .navbtn.prev{left:10px}
    .navbtn.next{right:10px}

    @media (max-width:860px){
      .controls{grid-template-columns:1fr 1fr}
      .hero{flex-direction:column;align-items:flex-start}
      .modal{grid-template-columns:1fr}
      .modal .left{aspect-ratio:4/3}
    }
  </style>
</head>
<body>
  <header class="topbar">
    <div class="container">
      <div class="brand">
        <div class="logo" aria-label="logo">DM</div>
        <div>
          <h1>Dr. Martens – poslední páry</h1>
          <small>Kontakt přes WhatsApp / Messenger • domluva / dobírka / osobně</small>
        </div>
      </div>
      <div class="controls" role="search" aria-label="Filtry katalogu">
        <input class="input" id="q" placeholder="Hledat: model / barva / kód…" aria-label="Hledat">
        <select id="size" aria-label="Velikost"><option value="">Velikost (EU)</option></select>
        <button class="cta" id="contactAll" title="Kontaktovat">Kontaktovat</button>
      </div>
      <div class="hero">
        <p>Vyprodáváme sklad ≤ poslední kusy. Pokud chceš jinou velikost, napiš – zkusíme dohledat.</p>
        <div class="badges">
          <span class="badge brand">Rychlá domluva</span>
          <span class="badge">Osobní odběr / dobírka</span>
          <span class="badge">Záruka vrácení dle domluvy</span>
        </div>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="grid" id="grid" aria-live="polite"></section>
  </main>

  <footer class="container">
    <strong>Kontakt:</strong>
    <a id="waLink" href="#" rel="nofollow noopener">WhatsApp</a> •
    <a id="msgrLink" href="#" rel="nofollow noopener">Messenger</a> •
    <a id="telLink" href="#">Telefon</a>
    <div style="margin-top:10px;color:#9a9aa2">© <span id="year"></span> Poslední páry Dr. Martens • Jednoduchý katalog, nákup až po domluvě</div>
  </footer>

  <dialog id="detail">
    <button class="close" onclick="closeDlg()" aria-label="Zavřít">✕</button>
    <div class="modal">
      <div class="left">
        <img id="dimg" alt="Náhled produktu" loading="lazy">
        <button class="navbtn prev" id="prevImg" aria-label="Předchozí">‹</button>
        <button class="navbtn next" id="nextImg" aria-label="Další">›</button>
      </div>
      <div class="right">
        <h3 id="dtitle"></h3>
        <div class="muted" id="dmeta"></div>
        <div class="price" style="margin:8px 0 2px">
          <div class="now" id="dprice"></div>
          <div class="was" id="dwas"></div>
        </div>
        <div class="muted" id="dcode"></div>
        <div class="opt">
          <select id="dsize"></select>
          <a class="btn" id="dwhats" target="_blank" rel="nofollow noopener">WhatsApp</a>
          <a class="btn" id="dmsgr" target="_blank" rel="nofollow noopener">Messenger</a>
        </div>
        <div style="color:#bdbdc6;font-size:14px">Domluvíme dopravu: osobně / zásilkovna / dobírka. Napiš, co ti sedne.</div>
      </div>
    </div>
  </dialog>

  <script>
    /* ===== KONFIG ===== */
    const STORE = {
      phone: "+420724535569",
      email: "alexandr.barta1@gmail.com",
      whatsappGreeting: "Ahoj, mám zájem o tyto boty:",
      city: "Praha",
      messenger: "https://m.me/61575315234939"
    };

    /* Placeholder obrázek */
    const PLACEHOLDER_SVG = 'data:image/svg+xml,'+encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 600 450'><rect width='600' height='450' fill='#0a0a0c'/><text x='50%' y='52%' fill='#7a7a80' text-anchor='middle' font-size='24' font-family='Arial'>Foto bude doplněno</text></svg>");
    function fallbackImg(img){ img.onerror=null; img.src=PLACEHOLDER_SVG; }

    /* ===== PRODUKTY (Polley → LEO) ===== */
    const PRODUCTS = [
      /* … nechal jsem tvůj aktuální seznam z poslední zprávy … */
      /* === P === */
    /* 1 */  { id:"polley-5027", name:"Dr. Martens Polley – Černé Mary Jane", sizes:["37"], price:2990, images:["images/Polley.jpg","images/Polley%201.jpg","images/Polley%202.jpg"] },
      { id:"drench-holinky", name:"Dr. Martens Drench – Černé holínky", sizes:["37","38"], price:990, images:["images/Drench%20holinky.webp"] },
      { id:"bpat-1460-bex-pascal", name:"Dr. Martens 1460 Pascal Bex – Tan Inuck", sizes:["37"], price:3499, images:["images/Bex%20pascal%201460%201.jpg","images/Bex%20pascal%201460%202.webp","images/Bex%20pascal%201460.jpg"] },
      { id:"cesca-red-r-3j65", name:"Dr. Martens Cesca – Červené kožené", sizes:["38","39"], price:990, images:["images/Kara.jpg","images/Kara%201.jpg","images/Kara%202.jpg"] },
      { id:"cesca-black", name:"Dr. Martens Cesca – Černé kožené", sizes:["37","38","39"], price:990, images:["images/Cesca%20Black.jpg","images/Cesca%20Black%201.jpg","images/Cesca%20Black%202.jpg"] },
      { id:"kara-red-r3j64", name:"Dr. Martens Kara – Červené kožené", sizes:["38","39"], price:1099, images:["images/Cesca%20Red.jpg","images/Cesca%20Red%201.jpg"] },
      { id:"cr1460", name:"Dr. Martens CR1460", sizes:["45","47"], price:2499, images:["images/CR%201460.webp","images/CR%201460%203.webp","images/CR%201460%201.webp","images/CR%201460%202.webp"] },
      { id:"lacey", name:"Dr. Martens Lacey", sizes:["38","39"], price:1199, images:["images/Lacey%201.jpg","images/Lacey.jpg"] },
      { id:"serena-1460", name:"Dr. Martens Serena – Černé s kožíškem", sizes:["38","39","40"], price:3499, images:["images/Serena.jpg","images/Serena%201.jpg","images/Serena%202.jpg"] },
      { id:"b1420", name:"Dr. Martens B1420 – Černé se zipem", sizes:["38","39","40"], price:1499, images:["images/B1420.jpg"] },
      { id:"redford-navy", name:"Dr. Martens Redford – Námořnická modrá", sizes:["43"], price:1999, images:["images/Redford%20Navy.webp","images/Redford%20Navy%201.webp","images/Redford%20Navy%202.webp","images/Redford%20Navy%203.webp"] },
      { id:"n1460", name:"Dr. Martens N1460 – Černé", sizes:["38"], price:2990, images:["images/N1460%201.avif","images/N1460.avif"] },
      { id:"nappa-1460", name:"Dr. Martens 1460 – Nappa", sizes:["38"], price:2990, images:["images/Nappa%201460%201.avif","images/Nappa%201460%202.avif","images/Nappa%201460%203.avif","images/Nappa%201460.avif"] },
      { id:"wbsm-1460", name:"Dr. Martens 1460 WBSM", sizes:["38"], price:3499, images:["images/WBSM.jpg"] },
      { id:"hicky-1460", name:"Dr. Martens 1460 – Černé (Hickey)", sizes:["37","38"], price:1999, images:["images/Hickey.jpg","images/Hickey%201460%201.webp","images/Hickey%201460%202.webp","images/Hickey%201460.webp"] },
      { id:"chay-1460", name:"Dr. Martens 1460 – Černé s puntíky", sizes:["37","38"], price:3499, images:["images/Chay%201460%201.webp","images/Chay%201460%202.webp","images/Chay%201460.webp"] },
      { id:"bg-939-black-greasy", name:"Dr. Martens 939 – Black Greasy", sizes:["39","43"], price:3499, images:["images/BG%20939.webp","images/BG%20939%201.webp","images/BG%20939%202.webp","images/BG%20939%203.webp"] },
      { id:"reeder", name:"Dr. Martens Reeder – Černé kožené", sizes:["43"], price:2990, images:["images/Reeder.webp","images/Reeder%201.avif","images/Reeder%201.webp","images/Reeder%202.webp","images/Reeder%203.webp"] },
      { id:"bc-1460", name:"Dr. Martens 1460 – Růžové kožené", sizes:["37","38"], price:1990, images:["images/bc-1460-1.jpg"] },
      { id:"g-ch1461", name:"Dr. Martens 1461 – Černé kožené", sizes:["43"], price:2990, images:["images/g-ch1461-1.jpg"] },
      { id:"amor-1461", name:"Dr. Martens 1461 Amor", sizes:["37"], price:2990, images:["images/Amor%201461.webp","images/Amor%201461%201.webp","images/Amor%201461%202.webp","images/Amor%201461%203.webp"] },
      { id:"bpat1461", name:"Dr. Martens 1461 Black Patent", sizes:["37"], price:2499, images:["images/BPAT.jpg","images/BPAT1.jpg","images/BPAT2.jpg"] },
      { id:"GCH939-misc", name:"Dr. Martens 939 GCH", sizes:["36","39","43"], price:2999, images:["images/GCH1.jpg","images/GCH.jpg"] },
      { id:"felton", name:"Dr. Martens Felton", sizes:["41"], price:1999, images:["images/Felton.jpg","images/Felton%201.jpg"] },
      { id:"flora-1460-dfl", name:"Dr. Martens Flora – Černé kožené", sizes:["37","38"], price:3499, images:["images/Flora1460.jpg",] },
      { id:"flora-1460-white-rose", name:"Dr. Martens - Bílá růže", sizes:["38","39"], price:3499, images:["images/WR.jpg","images/WR1.jpg"] },
     /* 23 */ { id:"leo-1460", name:"Dr. Martens 1460 – Leopardí vzor", sizes:["37","38","39"], price:1499, images:["images/LEO%201460%201.avif","images/LEO%201460.avif"] }

    ];

    /* ===== HELPERY PRO OBRÁZKY ===== */
    function getPics(p){
  const arr = (p && Array.isArray(p.imgs) && p.imgs.length) ? p.imgs
           : (p && Array.isArray(p.images) && p.images.length) ? p.images
           : [];
  // Když už je v datech %20, nejdřív to odkodujeme a pak zakódujeme JEDNOU.
  return arr.map(u => encodeURI(decodeURI(u)));
}

    function setBestImg(imgEl, pics){
      if(!imgEl){return;}
      if(!pics || !pics.length){ imgEl.src = PLACEHOLDER_SVG; return; }
      let i = 0;
      function tryNext(){
        if(i >= pics.length){ imgEl.src = PLACEHOLDER_SVG; return; }
        imgEl.onerror = ()=>{ i++; tryNext(); };
        imgEl.src = pics[i];
      }
      tryNext();
    }

    /* ===== OSTATNÍ HELPERS ===== */
    const el = s => document.querySelector(s);
    const money = n => new Intl.NumberFormat('cs-CZ',{style:'currency',currency:'CZK',maximumFractionDigits:0}).format(n);
    const waLink = text => `https://wa.me/${STORE.phone.replace(/\D/g,'')}?text=${encodeURIComponent(text)}`;

    /* Sizes → filtr */
    const ALL_SIZES = [...new Set(PRODUCTS.flatMap(p => p.sizes))].sort((a,b)=>+a-+b);
    const sizeSel = el('#size'); ALL_SIZES.forEach(s=>{ const o=document.createElement('option'); o.value=s; o.textContent=`EU ${s}`; sizeSel.appendChild(o); });

    /* Footer + kontakty */
    el('#waLink').href = waLink('Ahoj, mám dotaz k botám z katalogu.');
    el('#msgrLink').href = STORE.messenger;
    el('#telLink').href = `tel:${STORE.phone}`;
    el('#year').textContent = new Date().getFullYear();
    el('#contactAll').addEventListener('click', ()=> location.href = STORE.messenger);

    /* Render grid */
    const grid = el('#grid');
    function cardHTML(p){
      const sizesBadges = (p.sizes||[]).map(s=>`<span class="size">EU ${s}</span>`).join('');
      return `
        <article class="card">
          <div class="media" role="img" aria-label="${p.name}">
            <img alt="${p.name}" loading="lazy">
            ${p.last<=1 ? '<div class="flag">Poslední kus</div>' : ''}
            <div class="sold">EU ${p.sizes.join(', ')}</div>
          </div>
          <div class="body">
            <div class="title">${p.name}</div>
            <div class="meta"></div>
            <div class="price"><div class="now">${money(p.price)}</div>${p.was?`<div class="was">${money(p.was)}</div>`:''}</div>
            <div class="sizes">${sizesBadges}</div>
          </div>
          <div class="actions">
            <a class="btn detail" href="#" data-id="${p.id}">Detail</a>
            <a class="btn contact" href="#" data-id="${p.id}">Kontaktovat</a>
          </div>
        </article>`;
    }
    function render(list){
      if(!list.length){
        grid.innerHTML = `<div style="grid-column:1/-1;color:#bdbdc6;padding:20px">Nic jsme nenašli. Zkus filtr nebo napiš – často máme i jiné páry.</div>`;
        return;
      }
      grid.innerHTML = list.map(cardHTML).join('');

      // doplnit obrázky do karet
      Array.from(grid.children).forEach((card, i)=>{
        const pics = getPics(list[i]);
        const imgEl = card.querySelector('.media img');
        setBestImg(imgEl, pics);
      });

      // akce
      grid.querySelectorAll('.detail,.contact,.media').forEach(a=>{
        a.addEventListener('click', e=>{
          e.preventDefault();
          const article = a.closest('article');
          const id = article ? article.querySelector('.detail').getAttribute('data-id') : a.getAttribute('data-id');
          const prod = PRODUCTS.find(x=>x.id===id);
          if(!prod) return;
          if(a.classList.contains('contact')){
            const base = `${STORE.whatsappGreeting}
${prod.name}
Velikost: ${(prod.sizes && prod.sizes[0]) ? prod.sizes[0] : ''}
Město: ${STORE.city}`;
            window.open(waLink(base),'_blank');
          } else {
            openDetail(prod);
          }
        });
      });
    }

    /* Filtry */
    function applyFilters(){
      const q = el('#q').value.trim().toLowerCase();
      const size = el('#size').value;
      const list = PRODUCTS.filter(p=>{
        const text = `${p.name}`.toLowerCase();
        const okQ = !q || text.includes(q);
        const okSize = !size || (p.sizes||[]).includes(size);
        return okQ && okSize;
      });
      render(list);
    }
    el('#q').addEventListener('input', applyFilters);
    el('#size').addEventListener('input', applyFilters);

    /* Modal + šipky + zavírání */
    const detail = el('#detail');

    function openDlg(){ if(detail.showModal) detail.showModal(); else detail.setAttribute('open',''); }
    function closeDlg(){ if(detail.close) detail.close(); else detail.removeAttribute('open'); }

    detail.addEventListener('click', (e)=>{ if(e.target===detail) closeDlg(); });

    let touchStartY=null;
    detail.addEventListener('touchstart',(e)=>{touchStartY=e.touches[0].clientY;},{passive:true});
    detail.addEventListener('touchmove',(e)=>{
      if(touchStartY==null) return;
      const dy=e.touches[0].clientY-touchStartY;
      if(dy>80){ closeDlg(); touchStartY=null; }
    },{passive:true});
    detail.addEventListener('touchend',()=>{ touchStartY=null; });

    let curImgs=[], curIdx=0;
    function setMain(i){
      if(!curImgs.length){ el('#dimg').src=''; return; }
      if(i<0) i=curImgs.length-1;
      if(i>=curImgs.length) i=0;
      curIdx=i;
      setBestImg(el('#dimg'), [curImgs[i]]); // použij helper (pro jistotu)
    }
    function openDetail(p){
      el('#dtitle').textContent=p.name;
      el('#dmeta').textContent='';
      el('#dprice').textContent=money(p.price);
      el('#dwas').textContent=p.was?money(p.was):'';
      el('#dcode').textContent=p.code?`Kód: ${p.code}`:'';

      const dsize=el('#dsize'); dsize.innerHTML='';
      (p.sizes||[]).forEach(s=>{ const o=document.createElement('option'); o.value=s; o.textContent=`EU ${s}`; dsize.appendChild(o); });

      curImgs = getPics(p);
      setMain(0);
      el('#prevImg').onclick=()=>setMain(curIdx-1);
      el('#nextImg').onclick=()=>setMain(curIdx+1);

      const base = `${STORE.whatsappGreeting}
${p.name}
Velikost: ${(p.sizes&&p.sizes[0])?p.sizes[0]:''}
Město: ${STORE.city}`;
      el('#dwhats').href = waLink(base);
      el('#dmsgr').href  = STORE.messenger;
      dsize.addEventListener('change', function(){
        const b = `${STORE.whatsappGreeting}
${p.name}
Velikost: ${this.value}
Město: ${STORE.city}`;
        el('#dwhats').href = waLink(b);
      });

      openDlg();
    }

    // Auto-hide topbar na mobilu
    (function(){
      const bar=document.querySelector('.topbar'); if(!bar) return;
      let lastY=window.scrollY||0;
      window.addEventListener('scroll',()=>{
        const y=window.scrollY||0;
        if(y>lastY+6 && y>80) bar.classList.add('hide');
        else if(y<lastY-6) bar.classList.remove('hide');
        lastY=y;
      },{passive:true});
    })();

    /* Start */
    applyFilters();
  </script>
</body>
</html>
